(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{6250:function(e,t,a){Promise.resolve().then(a.bind(a,3750))},9205:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&a.indexOf(e)===t).join(" ")};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:a,strokeWidth:o?24*Number(i)/Number(s):i,className:n("lucide",c),...m},[...u.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let a=(0,r.forwardRef)((a,l)=>{let{className:o,...c}=a;return(0,r.createElement)(i,{ref:l,iconNode:t,className:n("lucide-".concat(s(e)),o),...c})});return a.displayName="".concat(e),a}},3247:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},4743:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},3750:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var r=a(7437),s=a(2265),n=a(5243),l=a(2593),i=a(3247);let o=[{id:1,name:"CS101 Study Group",lastMessage:"Does anyone have the notes?",time:"2m",unread:3,avatar:"https://api.dicebear.com/7.x/identicon/svg?seed=CS101",isGroup:!0},{id:2,name:"Sarah Jenkins",lastMessage:"See you at the library!",time:"1h",unread:0,avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sarah",isGroup:!1},{id:3,name:"Photography Club",lastMessage:"Photo walk this Saturday \uD83D\uDCF8",time:"3h",unread:12,avatar:"https://api.dicebear.com/7.x/identicon/svg?seed=Photo",isGroup:!0},{id:4,name:"Mike Chen",lastMessage:"Thanks for the help!",time:"1d",unread:0,avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Mike",isGroup:!1}];function c(){return(0,r.jsxs)(l.default,{className:"h-full flex flex-col p-0 border-r border-white/20 rounded-r-none",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-white/10",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-primary mb-4",children:"Messages"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary",size:16}),(0,r.jsx)("input",{type:"text",placeholder:"Search...",className:"w-full pl-9 pr-4 py-2 rounded-xl bg-white/50 border border-white/20 focus:border-primary focus:ring-1 focus:ring-primary outline-none text-sm transition-all"})]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:o.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl hover:bg-white/40 cursor-pointer transition-colors group",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-200 overflow-hidden",children:(0,r.jsx)("img",{src:e.avatar,alt:e.name,className:"w-full h-full object-cover"})}),e.unread>0&&(0,r.jsx)("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-primary text-white text-xs font-bold flex items-center justify-center rounded-full border-2 border-white",children:e.unread})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsx)("h3",{className:"font-bold text-text-main text-sm truncate",children:e.name}),(0,r.jsx)("span",{className:"text-xs text-text-secondary",children:e.time})]}),(0,r.jsx)("p",{className:"text-xs text-text-secondary truncate group-hover:text-text-main transition-colors",children:e.lastMessage})]})]},e.id))})]})}var d=a(3448);function u(e){let{message:t}=e;return(0,r.jsxs)("div",{className:(0,d.cn)("flex flex-col max-w-[70%] mb-4",t.isOwn?"self-end items-end":"self-start items-start"),children:[!t.isOwn&&t.sender&&(0,r.jsx)("span",{className:"text-xs text-text-secondary mb-1 ml-1",children:t.sender}),(0,r.jsx)("div",{className:(0,d.cn)("px-4 py-3 rounded-2xl shadow-sm",t.isOwn?"bg-primary text-white rounded-br-none":"bg-white/80 backdrop-blur-sm text-text-main rounded-bl-none border border-white/20"),children:t.content.startsWith("[IMAGE] ")?(0,r.jsx)("img",{src:t.content.replace("[IMAGE] ",""),alt:"Attachment",className:"max-w-full rounded-lg"}):(0,r.jsx)("p",{className:"text-sm",children:t.content})}),(0,r.jsx)("span",{className:"text-[10px] text-text-secondary mt-1 opacity-70",children:t.time})]})}var m=a(9205);let h=(0,m.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),x=(0,m.Z)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),f=(0,m.Z)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),p=(0,m.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);var b=a(4743),v=a(5526);function g(){let[e,t]=(0,s.useState)([]),[a,i]=(0,s.useState)(""),[o,d]=(0,s.useState)(null),[m,g]=(0,s.useState)(null),w=(0,s.useRef)(null),y=(0,s.useRef)(null),j="00000000-0000-0000-0000-000000000000";(0,s.useEffect)(()=>{(async()=>{let{data:{user:e}}=await v.O.auth.getUser();d(e);let{data:a}=await v.O.from("messages").select("*, profiles (full_name)").eq("room_id",j).order("created_at",{ascending:!0});a&&t(a);let r=v.O.channel("room:".concat(j)).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:"room_id=eq.".concat(j)},async e=>{let{data:a}=await v.O.from("messages").select("*, profiles(full_name)").eq("id",e.new.id).single();a&&t(e=>e.some(e=>e.id===a.id)?e:[...e,a])}).on("broadcast",{event:"call"},t=>{t.payload.caller_id!==(null==e?void 0:e.id)&&g({caller:t.payload.caller_name})}).subscribe();return()=>{v.O.removeChannel(r)}})()},[]),(0,s.useEffect)(()=>{var e;null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]);let N=async function(){var e;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(!r.trim()||!o)return;let n=crypto.randomUUID();"text"===s&&i("");let l={id:n,content:r,user_id:o.id,created_at:new Date().toISOString(),profiles:{full_name:(null===(e=o.user_metadata)||void 0===e?void 0:e.full_name)||"You"}};t(e=>[...e,l]);try{let{error:e}=await v.O.from("messages").insert({room_id:j,user_id:o.id,content:r});if(e)throw e}catch(e){console.error("Error sending message:",e),t(e=>e.filter(e=>e.id!==n)),"text"===s&&i(r)}},k=async e=>{if(e.target.files&&e.target.files[0]&&o){let t=e.target.files[0],a=t.name.split(".").pop(),r="".concat(o.id,"-").concat(Math.random(),".").concat(a);try{let{error:e}=await v.O.storage.from("chat-attachments").upload(r,t);if(e)throw e;let{data:{publicUrl:a}}=v.O.storage.from("chat-attachments").getPublicUrl(r);await N("[IMAGE] ".concat(a),"image")}catch(e){console.error("Error uploading file:",e),alert("Failed to upload file")}}},_=async()=>{var e;o&&(await v.O.channel("room:".concat(j)).send({type:"broadcast",event:"call",payload:{caller_id:o.id,caller_name:(null===(e=o.user_metadata)||void 0===e?void 0:e.full_name)||"User"}}),alert("Calling..."))};return(0,r.jsxs)("main",{className:"h-screen p-4 md:p-6 relative overflow-hidden flex gap-6",children:[(0,r.jsx)(n.default,{}),m&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)(l.default,{className:"p-8 text-center space-y-6",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-primary/20 rounded-full mx-auto flex items-center justify-center animate-pulse",children:(0,r.jsx)(h,{size:40,className:"text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-text-main",children:m.caller}),(0,r.jsx)("p",{className:"text-text-secondary",children:"is calling you..."})]}),(0,r.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,r.jsx)("button",{onClick:()=>g(null),className:"p-4 bg-red-500/20 text-red-500 rounded-full hover:bg-red-500/30 transition-colors",children:(0,r.jsx)(h,{size:24,className:"rotate-[135deg]"})}),(0,r.jsx)("button",{onClick:()=>{g(null),alert("Call connected!")},className:"p-4 bg-green-500/20 text-green-500 rounded-full hover:bg-green-500/30 transition-colors",children:(0,r.jsx)(h,{size:24})})]})]})}),(0,r.jsx)("div",{className:"w-full md:w-80 lg:w-96 flex-shrink-0 h-full hidden md:block",children:(0,r.jsx)(c,{})}),(0,r.jsxs)(l.default,{className:"flex-1 flex flex-col p-0 h-full overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-3 md:p-4 border-b border-white/10 flex items-center justify-between bg-white/30 backdrop-blur-md",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-gray-200 overflow-hidden",children:(0,r.jsx)("img",{src:"https://api.dicebear.com/7.x/identicon/svg?seed=General",alt:"Group",className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"font-bold text-text-main text-sm md:text-base",children:"General Chat"}),(0,r.jsx)("p",{className:"text-xs text-text-secondary",children:"Online"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 md:gap-2 text-text-secondary",children:[(0,r.jsx)("button",{onClick:_,className:"p-1.5 md:p-2 hover:bg-white/20 rounded-full transition-colors",children:(0,r.jsx)(h,{size:18,className:"md:w-5 md:h-5"})}),(0,r.jsx)("button",{onClick:_,className:"p-1.5 md:p-2 hover:bg-white/20 rounded-full transition-colors",children:(0,r.jsx)(x,{size:18,className:"md:w-5 md:h-5"})}),(0,r.jsx)("button",{className:"p-1.5 md:p-2 hover:bg-white/20 rounded-full transition-colors",children:(0,r.jsx)(f,{size:18,className:"md:w-5 md:h-5"})})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 flex flex-col",children:[e.map(e=>{var t;return(0,r.jsx)(u,{message:{content:e.content,isOwn:(null==o?void 0:o.id)===e.user_id,time:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),sender:null===(t=e.profiles)||void 0===t?void 0:t.full_name}},e.id)}),(0,r.jsx)("div",{ref:w})]}),(0,r.jsx)("div",{className:"p-3 md:p-4 bg-white/30 backdrop-blur-md border-t border-white/10",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-white/60 rounded-2xl p-2 border border-white/20 focus-within:ring-2 focus-within:ring-primary/20 transition-all",children:[(0,r.jsx)("button",{onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.click()},className:"p-2 text-text-secondary hover:text-primary transition-colors rounded-full hover:bg-white/50 hidden md:block",children:(0,r.jsx)(p,{size:20})}),(0,r.jsx)("input",{type:"file",ref:y,className:"hidden",onChange:k,accept:"image/*"}),(0,r.jsx)("input",{type:"text",value:a,onChange:e=>i(e.target.value),onKeyDown:e=>"Enter"===e.key&&N(),placeholder:"Type a message...",className:"flex-1 bg-transparent border-none outline-none text-text-main placeholder-text-muted px-2 text-sm md:text-base"}),(0,r.jsx)("button",{onClick:()=>N(),className:"p-2 bg-primary text-white rounded-xl hover:bg-primary-hover transition-colors shadow-lg shadow-primary/20",children:(0,r.jsx)(b.Z,{size:18})})]})})]})]})}},5243:function(e,t,a){"use strict";a.d(t,{default:function(){return n}});var r=a(7437),s=a(521);function n(){return(0,r.jsxs)("div",{className:"fixed inset-0 -z-10 overflow-hidden pointer-events-none",children:[(0,r.jsx)(s.E.div,{animate:{x:[0,100,0],y:[0,-50,0],scale:[1,1.2,1]},transition:{duration:20,repeat:1/0,ease:"easeInOut"},className:"absolute top-[-10%] left-[-10%] w-[50vw] h-[50vw] bg-primary/10 rounded-full blur-[100px]"}),(0,r.jsx)(s.E.div,{animate:{x:[0,-100,0],y:[0,100,0],scale:[1,1.5,1]},transition:{duration:25,repeat:1/0,ease:"easeInOut",delay:2},className:"absolute top-[20%] right-[-10%] w-[40vw] h-[40vw] bg-secondary/10 rounded-full blur-[120px]"}),(0,r.jsx)(s.E.div,{animate:{x:[0,50,0],y:[0,50,0],scale:[1,1.1,1]},transition:{duration:15,repeat:1/0,ease:"easeInOut",delay:5},className:"absolute bottom-[-10%] left-[20%] w-[60vw] h-[60vw] bg-primary-light/20 rounded-full blur-[100px]"})]})}},2593:function(e,t,a){"use strict";a.d(t,{default:function(){return n}});var r=a(7437),s=a(521);function n(e){let{children:t,className:a,hoverEffect:n=!0,...l}=e;return(0,r.jsx)(s.E.div,{whileHover:n?{y:-5,scale:1.01}:{},transition:{type:"spring",stiffness:300,damping:20},className:"\n        relative overflow-hidden\n        bg-surface/70 backdrop-blur-md\n        border border-white/20\n        shadow-glass\n        rounded-2xl\n        ".concat(a||"","\n      "),...l,children:(0,r.jsx)("div",{className:"relative z-10",children:t})})}},5526:function(e,t,a){"use strict";a.d(t,{O:function(){return r}});let r=(0,a(2577).createBrowserClient)("https://agakkvodhqinapxsqfou.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFnYWtrdm9kaHFpbmFweHNxZm91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3ODU1NDYsImV4cCI6MjA4MDM2MTU0Nn0.n5bhFCiK8bOwsUnZyjsLwxE_kv0NV4DScT6tHFAAFH8")},3448:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var r=a(1994),s=a(3335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[521,577,137,971,117,744],function(){return e(e.s=6250)}),_N_E=e.O()}]);